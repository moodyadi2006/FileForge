(()=>{var e={};e.id=14,e.ids=[14],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7361:(e,r,t)=>{"use strict";t.d(r,{N:()=>u});var s=t(13581),i=t(36344),o=t(78521),a=t(70616),n=t(85663);let u={providers:[(0,s.A)({id:"credentials",name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){await (0,o.A)();try{let r=await a.A.findOne({$or:[{email:e.identifier}]});if(!r||!r.isVerified)return null;return await n.Ay.compare(e.password,r.password)?r:null}catch(e){return null}}}),(0,i.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})],pages:{signIn:"/signIn"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET,callbacks:{async signIn({user:e,account:r}){if(console.log(e),r?.provider==="google"){await (0,o.A)();let r=await a.A.findOne({email:e.email});if(!r||!r.isVerified)return console.log("Blocked Google sign-in: User not found or not verified"),!1}return!0},async jwt({token:e,user:r,account:t}){let s=Math.floor(Date.now()/1e3);if(r&&(e.fullName=r.fullName||r.name,e.email=r.email),r&&t?.provider==="credentials"&&(e._id=r._id?.toString(),e.provider="credentials",e.accessToken=r._id?.toString()),t?.provider==="google"){e.provider="google",e.accessToken=t.access_token,e.expiresAt=s+(t.expires_at||3600),await (0,o.A)();let i=await a.A.findOne({email:r.email});i&&(e._id=i._id?.toString(),e.fullName=i.fullName)}return"google"===e.provider&&e.expiresAt&&e.expiresAt<s?(console.log("Google token expired, forcing logout"),null):e},session:async({session:e,token:r})=>r?(e.user._id=r._id,e.user.fullName=r.fullName,e.user.email=r.email,e.accessToken=r.accessToken,e.provider=r.provider,e.expiresAt=r.expiresAt,e):null}}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},41079:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>d,serverHooks:()=>x,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{GET:()=>c,POST:()=>c});var i=t(96559),o=t(48088),a=t(37719),n=t(19854),u=t.n(n),l=t(7361);let c=u()(l.N),d=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\Users\\addiv\\OneDrive\\Desktop\\Mars\\FileForge\\frontend\\src\\app\\api\\auth\\[...nextauth]\\route.js",nextConfigOutput:"",userland:s}),{workAsyncStorage:p,workUnitAsyncStorage:g,serverHooks:x}=d;function m(){return(0,a.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:g})}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56037:e=>{"use strict";e.exports=require("mongoose")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70616:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(56037),i=t.n(s);let o=new s.Schema({fullName:{type:String,required:!0,trim:!0},email:{type:String,required:!0,trim:!0,match:[/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,"Please use a valid email"],unique:!0},password:{type:String,required:!0,trim:!0},verifyCode:{type:String},isVerified:{type:Boolean,default:!1},verifyCodeExpiry:{type:Date}}),a=i().models.User||i().model("User",o)},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},78521:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(56037),i=t.n(s);let o={},a=async function(){if(o.isConnected)return void console.log("Already connected to databases");try{o.isConnected=(await i().connect(process.env.MONGODB_URI||"")).connections[0].readyState,console.log("DB connected successfully")}catch(e){console.log("DB connection failed"),process.exit(1)}}},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[719,613,793],()=>t(41079));module.exports=s})();